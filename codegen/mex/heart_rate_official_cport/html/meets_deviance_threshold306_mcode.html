<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,613" id="srcline613">613</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,614" id="srcline614">614</a></span><span class="line"><span class="comment">% RETURNS TRUE IF THE INPUT SIGNAL VALUE MEETS THE DEVIANCE REQS. NOTE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,615" id="srcline615">615</a></span><span class="line"><span class="comment">% THE THRESHOLD VALUE CHANGES BASED ON WHETHER DEVIANCE IS NEG OR POS</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,616" id="srcline616">616</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S73T101U1057">meets_deviance_req</span>] = meets_deviance_threshold(<span class="var type1" id="S74T43U1060">hr_value</span>, <span class="var type1" id="S75T7U1061">signal_level</span>, <span class="var type1" id="S76T7U1062">pos_deviance_threshold</span>, <span class="var type1" id="S77T7U1063">neg_deviance_threshold</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,617" id="srcline617">617</a></span><span class="line">        <span class="var type1" id="S78T8U1066">Fixed_Point_Properties</span> = numerictype(<span class="string">'WordLength'</span>, 32, <span class="string">'FractionLength'</span>, 12, <span class="string">'Signed'</span>,false);</span></span>
<span class="srcline"><span class="lineno"><a href="1,618" id="srcline618">618</a></span><span class="line">        <span class="var type1" id="S81T9U1078">F</span> = fimath(<span class="string">'OverflowMode'</span>,<span class="string">'saturate'</span>, <span class="string">'RoundMode'</span>, <span class="string">'nearest'</span>, <span class="string">'ProductFractionLength'</span>, 20,<span class="string">'ProductMode'</span>, <span class="string">'SpecifyPrecision'</span>, <span class="string">'MaxProductWordLength'</span>, 32, <span class="string">'SumFractionLength'</span>, 12, <span class="string">'SumMode'</span>, <span class="string">'SpecifyPrecision'</span>,<span class="string">'MaxSumWordLength'</span>, 32);</span></span>
<span class="srcline"><span class="lineno"><a href="1,619" id="srcline619">619</a></span><span class="line">        <span class="comment">% asserts that the input parameters are of fixed point</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,620" id="srcline620">620</a></span><span class="line">        assert(isfi(<span class="var type1" id="S74T43U1102">hr_value</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,621" id="srcline621">621</a></span><span class="line">        assert(isfi(<span class="var type1" id="S75T7U1108">signal_level</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,622" id="srcline622">622</a></span><span class="line">        assert(isfi(<span class="var type1" id="S76T7U1114">pos_deviance_threshold</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,623" id="srcline623">623</a></span><span class="line">        assert(isfi(<span class="var type1" id="S77T7U1120">neg_deviance_threshold</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,624" id="srcline624">624</a></span><span class="line">        <span class="comment">% asserts that input parameters are of specific fixed point parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,625" id="srcline625">625</a></span><span class="line">        assert(isequal(numerictype(<span class="var type1" id="S74T43U1129">hr_value</span>), <span class="var type1" id="S78T8U1130">Fixed_Point_Properties</span>) &amp;&amp; isequal(fimath(<span class="var type2" id="S74T0U1135">hr_value</span>), <span class="var type2" id="S81T0U1136">F</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,626" id="srcline626">626</a></span><span class="line">        assert(isequal(numerictype(<span class="var type1" id="S75T7U1145">signal_level</span>), <span class="var type1" id="S78T8U1146">Fixed_Point_Properties</span>) &amp;&amp; isequal(fimath(<span class="var type1" id="S75T7U1151">signal_level</span>), <span class="var type1" id="S81T9U1152">F</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,627" id="srcline627">627</a></span><span class="line">        assert(isequal(numerictype(<span class="var type1" id="S76T7U1161">pos_deviance_threshold</span>), <span class="var type1" id="S78T8U1162">Fixed_Point_Properties</span>) &amp;&amp; isequal(fimath(<span class="var type1" id="S76T7U1167">pos_deviance_threshold</span>), <span class="var type1" id="S81T9U1168">F</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,628" id="srcline628">628</a></span><span class="line">        assert(isequal(numerictype(<span class="var type1" id="S77T7U1177">neg_deviance_threshold</span>), <span class="var type1" id="S78T8U1178">Fixed_Point_Properties</span>) &amp;&amp; isequal(fimath(<span class="var type1" id="S77T7U1183">neg_deviance_threshold</span>), <span class="var type1" id="S81T9U1184">F</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="1,629" id="srcline629">629</a></span><span class="line">    <span class="comment">%Accounts for the first signal value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,630" id="srcline630">630</a></span><span class="line">    <span class="keyword">if</span> (<span class="var type1" id="S75T7U1189">signal_level</span> == 0)</span></span>
<span class="srcline"><span class="lineno"><a href="1,631" id="srcline631">631</a></span><span class="line">        <span class="var type2" id="S73T0U1193">meets_deviance_req</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,632" id="srcline632">632</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,633" id="srcline633">633</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,634" id="srcline634">634</a></span><span class="line"><span class="comment">%     signal_level</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,635" id="srcline635">635</a></span><span class="line"><span class="comment">%     hr_value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,636" id="srcline636">636</a></span><span class="line">    <span class="keyword">if</span> (<span class="var type1" id="S74T43U1200">hr_value</span> &lt; <span class="var type1" id="S75T7U1201">signal_level</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,637" id="srcline637">637</a></span><span class="line">        <span class="var type0" id="S86T0U1204">deviance</span> = ((<span class="message error" id="M19F306C"><span class="message error" id="M20F306C"><span class="var type1" id="S75T7U1210">signal_level</span> - <span class="var type1" id="S74T43U1211">hr_value</span></span></span>) * 100) / <span class="var type2" id="S75T0U1213">signal_level</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,638" id="srcline638">638</a></span><span class="line">        <span class="var type1" id="S87T2U1216">is_neg</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,639" id="srcline639">639</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,640" id="srcline640">640</a></span><span class="line">        <span class="var type0" id="S86T0U1221">deviance</span> = ((<span class="message error" id="M21F306C"><span class="message error" id="M22F306C"><span class="var type1" id="S74T43U1227">hr_value</span> - <span class="var type1" id="S75T7U1228">signal_level</span></span></span>) * 100) / <span class="var type2" id="S75T0U1230">signal_level</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,641" id="srcline641">641</a></span><span class="line">        <span class="var type1" id="S87T2U1233">is_neg</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,642" id="srcline642">642</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,643" id="srcline643">643</a></span><span class="line"><span class="comment">%     deviance = abs(raw_deviance);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,644" id="srcline644">644</a></span><span class="line">    <span class="comment">% APPLIES CHECK </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,645" id="srcline645">645</a></span><span class="line">    <span class="keyword">if</span> (<span class="var type1" id="S87T2U1238">is_neg</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,646" id="srcline646">646</a></span><span class="line">        <span class="keyword">if</span> (<span class="var type0" id="S86T0U1243"><span class="message error" id="M23F306C">deviance</span></span> &lt; <span class="var type2" id="S77T0U1245">neg_deviance_threshold</span> * 100)</span></span>
<span class="srcline"><span class="lineno"><a href="1,647" id="srcline647">647</a></span><span class="line">            <span class="var type2" id="S73T0U1249">meets_deviance_req</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,648" id="srcline648">648</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,649" id="srcline649">649</a></span><span class="line">            <span class="var type2" id="S73T0U1254">meets_deviance_req</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,650" id="srcline650">650</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,651" id="srcline651">651</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,652" id="srcline652">652</a></span><span class="line">        <span class="keyword">if</span> (<span class="var type0" id="S86T0U1261"><span class="message fatal" id="M24F306C">deviance</span></span> &lt; <span class="var type2" id="S76T0U1263">pos_deviance_threshold</span> * 100)</span></span>
<span class="srcline"><span class="lineno"><a href="1,653" id="srcline653">653</a></span><span class="line">            <span class="var type2" id="S73T0U1267">meets_deviance_req</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="1,654" id="srcline654">654</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,655" id="srcline655">655</a></span><span class="line">            <span class="var type2" id="S73T0U1272">meets_deviance_req</span> = 0;</span></span>
<span class="srcline"><span class="lineno"><a href="1,656" id="srcline656">656</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,657" id="srcline657">657</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,658" id="srcline658">658</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,659" id="srcline659">659</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,660" id="srcline660">660</a></span><span class="line"><span class="comment">%DUAL THRESHOLD PROCESSSING</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,661" id="srcline661">661</a></span><span class="line"><span class="comment">% Filters out R_peaks which don't meet the threshold reqs</span></span></span>
</pre>
